# スキル設計のベストプラクティス

## 1. description の書き方（最重要）

`description` は Copilot がスキルを読み込むかどうかを判断する唯一の材料です。

### 良い例

```yaml
description: ユニットテストを作成・改善するスキル。テストカバレッジの向上、テストパターンの適用、モックの最適化を支援する。「テスト書いて」「テスト追加」「カバレッジ」「ユニットテスト」「test」などで発火。
```

### 悪い例

```yaml
description: テスト関連のスキルです。
```

### チェックポイント

- [ ] 1行で完結している（`|` や改行を使わない）
- [ ] 「何をするスキルか」が明記されている
- [ ] 「どんな時に使うか」が含まれている
- [ ] 発火キーワードが具体的に列挙されている
- [ ] 日本語と英語の両方のキーワードがある
- [ ] 最大1024文字以内

## 2. SKILL.md の構成原則

### スリムに保つ

SKILL.md は「手順書」であり「百科事典」ではない。

- **手順（Step）と方針** → SKILL.md に記述
- **テンプレート・ひな型** → `assets/` に分離
- **詳細な仕様・リファレンス** → `references/` に分離
- **コード例・サンプル** → `examples/` に分離
- **実行可能スクリプト** → `scripts/` に分離

### 推奨構造

```markdown
# スキル名

## スキル読み込み通知

このスキルが読み込まれたら、必ず以下の通知をユーザーに表示してください：

> 💡 **スキル名 スキルを読み込みました**  
> このスキルの目的を1文で簡潔に説明

## When to Use
- [発火条件を箇条書き]

## 手順
### Step 1: ...
### Step 2: ...

## 参照ドキュメント
- [外部ファイルへのリンク]
```

> ⚠️ **スキル読み込み通知セクションは必須です。**
> ユーザーがどのスキルが読み込まれたかを把握できるよう、すべてのスキルに含めてください。

## 3. name の命名規則

| ルール | 詳細 |
|--------|------|
| 文字種 | 小文字英字 `a-z`、数字 `0-9`、ハイフン `-` |
| 最大長 | 64文字 |
| ハイフン | 先頭・末尾は不可 |
| 意味 | 機能を端的に表す名前にする |

### 良い名前の例

- `unit-testing` — ユニットテスト生成
- `security-audit` — セキュリティ監査
- `api-docs-generator` — API ドキュメント生成
- `code-review` — コードレビュー支援

## 4. フォルダの使い分け

### いつフォルダを追加するか

| 条件 | 追加するフォルダ |
|------|----------------|
| 出力テンプレートがある | `assets/` |
| 診断・変換スクリプトがある | `scripts/` |
| ベストプラクティスや仕様表がある | `references/` |
| サンプルコードで説明が必要 | `examples/` |
| 上記がすべて不要 | SKILL.md のみ |

### 実装パターン・注意点リファレンスの推奨

プロジェクト固有のオーバービュースキル（例: `xxx-overview`）には、技術スタックやディレクトリ構成だけでなく、**実装パターン・注意点のリファレンス** を `references/` に含めることを強く推奨する。

調査方法・出力フォーマット・完全な例は以下のガイドを参照：

📄 **[references/implementation-patterns-guide.md](../skills-generator/references/implementation-patterns-guide.md)**

このガイドには以下が含まれる：
- **10カテゴリの調査軸**（誤操作防止、ブラックアウト対策、ブラウザAPI制約、メモリ管理、エラーハンドリング、パフォーマンス最適化、モバイル対応、データ永続化、メディア処理、状態管理）
- **各カテゴリの検索キーワードと調査対象**
- **出力フォーマット**（問題・対策・注意の3要素）
- **実際の出力例**（動画編集アプリの場合）

これにより AI がコード変更時に既存のパターンを壊さず、プロジェクトの設計思想に沿った実装を行える。

### いつフォルダを追加しないか

- スキルの指示が50行以下でシンプルに完結する場合
- テンプレートもコード例も不要な場合
- → SKILL.md 1ファイルで十分

## 5. 汎用スキル vs プロジェクト固有スキル

| 観点 | 汎用スキル | プロジェクト固有スキル |
|------|----------|---------------------|
| 配置先 | `~/.copilot/skills/` | `.github/skills/` |
| 技術名のハードコード | ❌ 避ける | ✅ OK |
| ファイルパスの決め打ち | ❌ 避ける | ✅ OK |
| 具体的なコマンド | パラメータ化する | 直接記述OK |
| 参照ドキュメント | 汎用的な仕様を参照 | プロジェクトのファイルを参照 |

### 汎用スキルを書く際の注意

- 特定のフレームワークやライブラリに依存しない記述を心がける
- 「このプロジェクトでは〜」ではなく「対象プロジェクトの〜を確認する」と書く
- パスは相対パスを前提とし、絶対パスをハードコードしない

## 6. 発火しない場合の対処法

description を調整しても発火しない場合、以下の方法で対処する：

### 方法1: チャットで明示的に指定

```
「{skill-name} スキルを使用して〜してください」
```

### 方法2: copilot-instructions.md にルーティングを追加

```markdown
## Agent Skills Routing

| キーワード | スキル | パス |
|-----------|--------|------|
| テスト | unit-testing | `.github/skills/unit-testing/SKILL.md` |
```

### 方法3: description にキーワードを追加

ユーザーが使いそうな自然言語フレーズを `description` に追加する。
