---
name: test-improvement
description: 開発ワークスペース共通のテスト改善スキル。既存テストを診断し、回帰を検出できるテスト観点と自動チェックを整備する。「テスト内容を強化」「テストを見直し」「テスト内容を確認」「テストを自動化」「意味のあるテスト」「回帰テストを追加」「ユニットテスト追加」「テスト戦略」で発火。
---

# Test Improvement

## スキル読み込み通知

このスキルが読み込まれたら、必ず以下の通知をユーザーに表示してください：

> 💡 **Test Improvement スキルを読み込みました**  
> 回帰を検出できるテスト観点の診断と自動チェック整備を行います。

## When to Use

- 既存テストが通るのに不具合が継続し、テストの有効性を見直したいとき
- 変更時に回帰を確実に検出できるユニットテスト/単体テストを追加したいとき
- マージ前に `test + lint + build` の自動チェックを一括実行したいとき

## 概要

このスキルは、テストの「通過」ではなく「検出力」を重視して品質を改善します。
既存テスト項目を分析し、欠けている境界条件や失敗パターンを特定し、再現テストを先に追加してから修正を行います。
最後にテスト・静的解析・ビルドを実行し、追加したテストが回帰を検出できる状態を確認します。

## 手順

### Step 1: 現状テストの把握

- 既存のテスト対象と観点を整理する
- 不具合の再現条件と、現在のテストで検出できていない理由を言語化する
- 調査結果を `references/quality-checklist.md` の「診断チェック」で確認する

### Step 2: 不足観点の補完

- 不具合を再現する失敗テストを先に作成する
- 必要に応じて複雑なロジックを純関数へ分離し、ユニットテストしやすくする
- 境界値、順序依存、非同期待機、状態遷移の観点を追加する

### Step 3: 自動チェックの実行と報告

- プロジェクト既定のコマンドで次を順番に実行する
  - テスト
  - 静的解析（lint/typecheck など）
  - ビルド
- 一括実行スクリプトがある場合はそれを使用する（例: `npm run quality:gate`）
- 追加前後で「何が検出できるようになったか」を明確に報告する

## 参照ドキュメント

- [references/quality-checklist.md](references/quality-checklist.md) — テスト診断・追加・報告のチェックリスト
